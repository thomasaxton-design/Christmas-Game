<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no" />
  <title>Tap the Image</title>

  <style>
    html, body {
      margin: 0;
      height: 100%;
      background: #000;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      overflow: hidden;
    }

    canvas {
      display: block;
      width: 100%;
      height: 100%;
      touch-action: none;
    }

    .hud {
      position: fixed;
      inset: 0;
      pointer-events: none;
      color: #fff;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: max(14px, env(safe-area-inset-top)) 14px max(14px, env(safe-area-inset-bottom));
      text-shadow: 0 2px 12px rgba(0,0,0,.6);
    }

    .badge {
      background: rgba(0,0,0,.45);
      border: 1px solid rgba(255,255,255,.2);
      padding: 10px 14px;
      border-radius: 14px;
      backdrop-filter: blur(6px);
      font-weight: 600;
    }

    .overlay {
      position: fixed;
      inset: 0;
      display: none;
      place-items: center;
      background: rgba(0,0,0,.7);
      padding: 20px;
    }

    .card {
      background: rgba(255,255,255,.12);
      border: 1px solid rgba(255,255,255,.25);
      border-radius: 18px;
      padding: 22px 20px;
      text-align: center;
      color: #fff;
      max-width: 520px;
      backdrop-filter: blur(10px);
    }

    .reveal {
      font-size: clamp(22px, 6vw, 34px);
      font-weight: 900;
      margin: 12px 0;
    }

    button {
      border: 1px solid rgba(255,255,255,.25);
      background: rgba(0,0,0,.35);
      color: #fff;
      padding: 10px 14px;
      border-radius: 14px;
      font-weight: 600;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<canvas id="c"></canvas>

<div class="hud">
  <div class="badge" id="meter">00:60 ‚Ä¢ 0/10</div>
</div>

<div class="overlay" id="overlay">
  <div class="card">
    <div>Well played üçª</div>
    <div class="reveal">Christmas pint at the brig?</div>
    <button onclick="location.reload()">Play again</button>
  </div>
</div>

<script>
(() => {
  const canvas = document.getElementById("c");
  const ctx = canvas.getContext("2d");

  const meter = document.getElementById("meter");
  const overlay = document.getElementById("overlay");

  const IMAGE_SRC = "c488fa84-3efe-4de2-b0a8-e81e85194c79.jpeg";

  const TOTAL_TIME = 60;
  const REQUIRED_TAPS = 10;

  const SPEED_MIN = 450;
  const SPEED_MAX = 750;

  let taps = 0;
  let startTime = performance.now();
  let lastTime = startTime;
  let gameOver = false;

  const img = new Image();
  img.src = IMAGE_SRC;

  const target = {
    x: 200,
    y: 200,
    vx: 0,
    vy: 0,
    size: 90
  };

  function resize() {
    const dpr = Math.min(3, window.devicePixelRatio || 1);
    canvas.width = innerWidth * dpr;
    canvas.height = innerHeight * dpr;
    canvas.style.width = innerWidth + "px";
    canvas.style.height = innerHeight + "px";
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
  }
  window.addEventListener("resize", resize);
  resize();

  function randomVelocity() {
    const angle = Math.random() * Math.PI * 2;
    const speed = SPEED_MIN + Math.random() * (SPEED_MAX - SPEED_MIN);
    target.vx = Math.cos(angle) * speed;
    target.vy = Math.sin(angle) * speed;
  }

  function respawn() {
    target.x = Math.random() * (innerWidth - target.size);
    target.y = Math.random() * (innerHeight - target.size);
    randomVelocity();
  }

  function update(dt) {
    target.x += target.vx * dt;
    target.y += target.vy * dt;

    if (target.x <= 0 || target.x + target.size >= innerWidth) target.vx *= -1;
    if (target.y <= 0 || target.y + target.size >= innerHeight) target.vy *= -1;
  }

  function draw() {
    ctx.clearRect(0, 0, innerWidth, innerHeight);

    ctx.drawImage(
      img,
      target.x,
      target.y,
      target.size,
      target.size
    );
  }

  function loop(now) {
    const elapsed = (now - startTime) / 1000;
    const remaining = Math.max(0, Math.ceil(TOTAL_TIME - elapsed));

    meter.textContent = `00:${String(remaining).padStart(2,"0")} ‚Ä¢ ${taps}/${REQUIRED_TAPS}`;

    if (!gameOver && remaining <= 0) {
      overlay.style.display = "grid";
      gameOver = true;
    }

    const dt = Math.min(0.05, (now - lastTime) / 1000);
    lastTime = now;

    if (!gameOver) {
      update(dt);
      draw();
      requestAnimationFrame(loop);
    }
  }

  canvas.addEventListener("pointerdown", e => {
    if (gameOver) return;

    const rect = canvas.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;

    if (
      x >= target.x &&
      x <= target.x + target.size &&
      y >= target.y &&
      y <= target.y + target.size
    ) {
      taps++;
      navigator.vibrate?.(15);

      if (taps >= REQUIRED_TAPS) {
        overlay.style.display = "grid";
        gameOver = true;
      } else {
        respawn();
      }
    }
  });

  img.onload = () => {
    respawn();
    requestAnimationFrame(loop);
  };
})();
</script>

</body>
</html>
